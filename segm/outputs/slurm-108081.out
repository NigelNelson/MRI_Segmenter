MOFED version '4.9-2.2.6' not available in this container.
No matching alternate version found.
wandb: Currently logged in as: nigelnel (nigel_nelson). Use `wandb login --relogin` to force relogin
Starting process with rank 0...
Process 0 is connected.
All processes are connected.
wandb: wandb version 0.13.11 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.13.10
wandb: Run data is saved locally in /home/nelsonni/laviolette/segmenter/wandb/run-20230310_153805-rhw7ceat
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dashing-music-19
wandb: ‚≠êÔ∏è View project at https://wandb.ai/nigel_nelson/segmenter_training
wandb: üöÄ View run at https://wandb.ai/nigel_nelson/segmenter_training/runs/rhw7ceat
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: - 0.010 MB of 0.010 MB uploaded (0.000 MB deduped)wandb: \ 0.010 MB of 0.010 MB uploaded (0.000 MB deduped)wandb: üöÄ View run dashing-music-19 at: https://wandb.ai/nigel_nelson/segmenter_training/runs/rhw7ceat
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230310_153805-rhw7ceat/logs
Traceback (most recent call last):
  File "/opt/conda/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/nelsonni/laviolette/segmenter/segm/train_unet.py", line 359, in <module>
    main()
  File "/opt/conda/lib/python3.6/site-packages/click/core.py", line 829, in __call__
    return self.main(*args, **kwargs)
  File "/opt/conda/lib/python3.6/site-packages/click/core.py", line 782, in main
    rv = self.invoke(ctx)
  File "/opt/conda/lib/python3.6/site-packages/click/core.py", line 1066, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/opt/conda/lib/python3.6/site-packages/click/core.py", line 610, in invoke
    return callback(*args, **kwargs)
  File "/home/nelsonni/laviolette/segmenter/segm/train_unet.py", line 306, in main
    class_weights
  File "/home/nelsonni/laviolette/segmenter/segm/engine.py", line 48, in train_one_epoch
    seg_pred = model.forward(im)
  File "/home/nelsonni/laviolette/segmenter/segm/unet/unet_model.py", line 26, in forward
    x1 = self.inc(x)
  File "/home/nelsonni/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/nelsonni/laviolette/segmenter/segm/unet/unet_parts.py", line 25, in forward
    return self.double_conv(x)
  File "/home/nelsonni/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/nelsonni/.local/lib/python3.6/site-packages/torch/nn/modules/container.py", line 141, in forward
    input = module(input)
  File "/home/nelsonni/.local/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/nelsonni/.local/lib/python3.6/site-packages/torch/nn/modules/conv.py", line 446, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/nelsonni/.local/lib/python3.6/site-packages/torch/nn/modules/conv.py", line 443, in _conv_forward
    self.padding, self.dilation, self.groups)
RuntimeError: Given groups=1, weight of size [64, 1, 3, 3], expected input[2, 3, 512, 512] to have 1 channels, but got 3 channels instead
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1107/10
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1107/11
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1107/12
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1107/13
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1107/5
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1107/6
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1107/7
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1107/8
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1111/9
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1111/7
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1111/5
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1118/6
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1118/15
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1118/12
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1118/13
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1118/14
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1121/6
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1123/11
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1123/12
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1123/5
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1123/6
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1124/13
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1124/5
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1125/12
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1125/5
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1125/6
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1128/13
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1128/14
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1128/6
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1129/10
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1129/11
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1129/5
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1129/6
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1129/7
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1131/10
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1131/11
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1131/9
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1132/11
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1132/13
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1132/14
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1134/10
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1134/7
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1134/8
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1134/9
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1136/10
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1136/11
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1136/12
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1136/13
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1136/14
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1136/15
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1136/7
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1137/10
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1137/11
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1137/5
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1138/10
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1138/6
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1138/7
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1138/8
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1138/9
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1140/14
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1140/15
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1140/16
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1140/17
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1141/10
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1141/11
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1141/12
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1141/9
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1142/5
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1147/15
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1147/5
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1148/10
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1148/11
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1148/12
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1154/14
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1154/15
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1154/5
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1154/6
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1155/13
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1155/14
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1158/13
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1158/15
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1159/12
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1159/13
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1159/14
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1187/12
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1187/13
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1188/14
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1188/8
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1188/9
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1191/19
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1191/9
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1200/15
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1200/16
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1203/10
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1204/10
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1204/19
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1204/8
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1204/9
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1149/10
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1149/11
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1149/12
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1149/13
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1149/5
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1149/6
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1149/8
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1149/9
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1144/11
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1144/12
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1144/13
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1144/5
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1144/6
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1144/8
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1126/12
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1126/13
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1126/14
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1126/5
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1122/9
'NoneType' object has no attribute 'shape'
Skipping /data/ur/bukowy/LaViolette_Data/Prostates/1122/11
'NoneType' object has no attribute 'shape'
Configuration:
algorithm_kwargs:
  batch_size: 2
  eval_freq: 2
  num_epochs: 200
  start_epoch: 0
amp: false
dataset_kwargs:
  batch_size: 2
  crop_size: 512
  dataset: ade20k
  image_size: 512
  normalization: vit
  num_workers: 10
  split: train
inference_kwargs:
  im_size: 512
  window_size: 512
  window_stride: 512
log_dir: unet_200_noCrop
net_kwargs:
  backbone: vit_tiny_patch16_384
  d_model: 192
  decoder:
    drop_path_rate: 0.0
    dropout: 0.1
    n_layers: 2
    name: mask_transformer
  distilled: false
  drop_path_rate: 0.1
  dropout: 0.0
  image_size: !!python/tuple
  - 512
  - 512
  n_cls: 8
  n_heads: 3
  n_layers: 12
  normalization: vit
  patch_size: 16
optimizer_kwargs:
  clip_grad: null
  epochs: 200
  iter_max: 17400
  iter_warmup: 0.0
  lr: 0.001
  min_lr: 1.0e-05
  momentum: 0.9
  opt: sgd
  poly_power: 0.9
  poly_step_size: 1
  sched: polynomial
  weight_decay: 0.0
resume: false
version: normal
world_batch_size: 2

Train dataset length: 174
Val dataset length: 14
training values: tensor([0., 1., 2., 4., 5., 6.])
training values: tensor([0., 2., 4., 5.])
